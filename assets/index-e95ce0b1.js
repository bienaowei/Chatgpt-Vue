import{aw as a,ax as d,ay as m}from"./index-05152c9f.js";const g="SECRET_TOKEN";function A(){return a.get(g)}function C(t){return a.set(g,t)}function k(){return a.remove(g)}function v({url:t,data:e,method:s,headers:o,onDownloadProgress:c,signal:u,beforeRequest:r,afterRequest:i}){const p=n=>{const y=T();return n.data.status==="Success"||typeof n.data=="string"?n.data:(n.data.status==="Unauthorized"&&(y.removeToken(),window.location.reload()),Promise.reject(n.data))},S=n=>{throw i==null||i(),new Error((n==null?void 0:n.message)||"Error")};r==null||r(),s=s||"GET";const f=Object.assign(typeof e=="function"?e():e??{},{});return s==="GET"?d.get(t,{params:f,signal:u,onDownloadProgress:c}).then(p,S):d.post(t,f,{headers:o,signal:u,onDownloadProgress:c}).then(p,S)}function h({url:t,data:e,method:s="POST",headers:o,onDownloadProgress:c,signal:u,beforeRequest:r,afterRequest:i}){return v({url:t,method:s,data:e,headers:o,onDownloadProgress:c,signal:u,beforeRequest:r,afterRequest:i})}function I(){return h({url:"/config"})}function M(t){const e=O(),s=T();let o={prompt:t.prompt,options:t.options};return s.isChatGPTAPI&&(o={...o,systemMessage:e.systemMessage,temperature:e.temperature,top_p:e.top_p}),h({url:"/chat-process",data:o,signal:t.signal,onDownloadProgress:t.onDownloadProgress})}function w(){return h({url:"/session"})}const T=m("auth-store",{state:()=>({token:A(),session:null}),getters:{isChatGPTAPI(t){var e;return((e=t.session)==null?void 0:e.model)==="ChatGPTAPI"}},actions:{async getSession(){try{const{data:t}=await w();return this.session={...t},Promise.resolve(t)}catch(t){return Promise.reject(t)}},setToken(t){this.token=t,C(t)},removeToken(){this.token=void 0,k()}}}),l="settingsStorage";function P(){return{systemMessage:"You are ChatGPT, a large language model trained by OpenAI. Follow the user's instructions carefully. Respond using markdown.",temperature:.8,top_p:1}}function E(){const t=a.get(l);return{...P(),...t}}function L(t){a.set(l,t)}function G(){a.remove(l)}const O=m("setting-store",{state:()=>E(),actions:{updateSetting(t){this.$state={...this.$state,...t},this.recordState()},resetSetting(){this.$state=P(),G()},recordState(){L(this.$state)}}});export{I as a,O as b,M as f,T as u};
